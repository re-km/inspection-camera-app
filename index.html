<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>【横向き専用】高画質点検カメラ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"></script>
    <script async src="https://docs.opencv.org/4.9.0/opencv.js" id="opencv-js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/piexifjs/1.0.6/piexif.js"></script>
    <style>
        /* 基本スタイル: 横向き専用 */
        html, body, #app-container { height: 100%; width: 100%; margin: 0; overflow: hidden; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .section { height: 100vh; display: flex; flex-direction: column; }
        #capture-btn { width: 64px; height: 64px; border-radius: 50%; border: 5px solid white; background-color: rgba(255, 255, 255, 0.3); transition: background-color 0.2s; }
        #capture-btn:active { background-color: rgba(255, 255, 255, 0.6); }
        #photo-gallery { scrollbar-width: none; -ms-overflow-style: none; }
        #photo-gallery::-webkit-scrollbar { display: none; }
        #selection-box { position: absolute; border: 2px dashed #00aeff; background-color: rgba(0, 174, 255, 0.2); pointer-events: none; }
        #camera-frame { transition: box-shadow 0.3s ease-in-out; }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; }
        #camera-stream { width: 100%; height: 100%; object-fit: contain; }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <div id="app-container" class="flex flex-row h-full">

        <!-- 左セクション: PDFビューア -->
        <div id="pdf-section" class="section w-1/2 p-2 bg-gray-800">
            <div class="flex-shrink-0">
                 <div class="flex flex-wrap gap-2 mb-2">
                    <label for="pdf-upload" class="flex-grow text-center cursor-pointer bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-3 rounded-lg text-sm">PDF選択</label>
                    <button id="toggle-compare-btn" class="flex-grow text-center bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-3 rounded-lg text-sm">🖼️ 比較</button>
                </div>
                 <input type="file" id="pdf-upload" class="hidden" accept=".pdf">
            </div>
            <div id="pdf-viewer-wrapper" class="flex-grow overflow-auto bg-gray-700 rounded-lg relative mt-1">
                <div id="pdf-viewer" class="w-full relative"></div>
                <div id="pdf-placeholder" class="absolute inset-0 flex items-center justify-center text-gray-400">PDFを選択</div>
                <div id="selection-box" class="hidden"></div>
            </div>
            <div id="pdf-controls" class="flex items-center justify-center mt-1 flex-shrink-0 hidden">
                <button id="prev-page" class="bg-gray-600 hover:bg-gray-500 font-bold py-1 px-3 rounded-l-lg">◀</button>
                <span id="page-num" class="bg-gray-800 py-1 px-2 text-sm"></span>/<span id="page-count" class="bg-gray-800 py-1 px-2 text-sm"></span>
                <button id="next-page" class="bg-gray-600 hover:bg-gray-500 font-bold py-1 px-3 rounded-r-lg">▶</button>
            </div>
        </div>

        <!-- 右セクション: カメラと撮影結果 -->
        <div id="camera-section" class="section w-1/2 p-2 bg-gray-900">
            <div id="camera-frame" class="relative flex-grow bg-black rounded-lg mb-2">
                <video id="camera-stream" autoplay playsinline></video>
                <div id="match-indicator" class="hidden absolute top-2 right-2 bg-green-500 text-white font-bold text-sm px-3 py-1 rounded-full shadow-lg z-20"></div>
                <div class="absolute top-2 left-2 bg-black bg-opacity-50 p-1 rounded-md text-xs z-20">
                    <div><span id="gps-status-dot" class="status-dot bg-red-500"></span> GPS</div>
                    <div><span id="compass-status-dot" class="status-dot bg-red-500"></span> 方位</div>
                </div>
                <div class="absolute bottom-4 left-1/2 -translate-x-1/2 z-10">
                    <button id="capture-btn" title="撮影"></button>
                </div>
            </div>
            <div class="flex-shrink-0 h-24">
                <div id="target-image-container" class="mb-1 hidden items-center space-x-2">
                    <img id="target-image" class="h-12 border-2 border-teal-500 rounded-md inline-block">
                    <button id="ai-assistant-btn" class="bg-fuchsia-600 hover:bg-fuchsia-700 text-white font-bold py-2 px-3 rounded-lg text-sm">✨ AIアシスタント</button>
                </div>
                <div id="photo-gallery" class="h-full bg-gray-800 rounded-lg p-2 flex space-x-2 overflow-x-auto">
                    <div id="gallery-placeholder" class="w-full h-full flex items-center justify-center text-gray-500">撮影写真</div>
                </div>
            </div>
        </div>
    </div>

    <!-- 各種非表示要素 -->
    <canvas id="capture-canvas" class="hidden"></canvas>
    <div id="gemini-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-lg p-6 w-11/12 max-w-3xl text-white shadow-2xl max-h-[90vh] flex flex-col">
            <h3 id="modal-title" class="text-2xl font-bold mb-4 flex items-center flex-shrink-0"></h3>
            <div class="overflow-y-auto pr-4">
                <div id="gemini-modal-content" class="min-h-[100px]"></div>
                <div id="report-generation-area" class="mt-6 hidden">
                    <h4 class="text-xl font-semibold border-t border-gray-600 pt-4">報告書（案）</h4>
                    <div id="report-content" class="mt-2 p-4 bg-gray-900 rounded-lg min-h-[150px] whitespace-pre-wrap"></div>
                    <div class="text-right mt-2">
                         <button id="copy-report-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg">文章をコピー</button>
                    </div>
                </div>
            </div>
            <div class="mt-6 text-right flex-shrink-0">
                <button id="close-modal-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg">閉じる</button>
            </div>
        </div>
    </div>

    <script>
    // --- グローバル変数と要素取得 ---
    const elements = {};
    let pdfDoc = null, currentPageNum = 1, pageIsRendering = false, pageNumIsPending = null;
    let isCompareMode = false, isSelecting = false;
    let selectionStart = { x: 0, y: 0 };
    let targetImageDataUrl = null;
    let frameCount = 0;
    const MATCH_THRESHOLD = 0.7;
    let cv = null;
    const sensorData = { latitude: null, longitude: null, heading: null };

    // --- メイン初期化処理 ---
    document.addEventListener('DOMContentLoaded', () => {
        const ids = ['pdf-upload', 'pdf-viewer', 'pdf-placeholder', 'pdf-controls', 'prev-page', 'next-page', 'page-num', 'page-count', 'camera-stream', 'capture-btn', 'capture-canvas', 'photo-gallery', 'gallery-placeholder', 'gemini-modal', 'gemini-modal-content', 'close-modal-btn', 'toggle-compare-btn', 'selection-box', 'target-image-container', 'target-image', 'camera-frame', 'match-indicator', 'opencv-js', 'gps-status-dot', 'compass-status-dot', 'report-generation-area', 'report-content', 'copy-report-btn', 'pdf-viewer-wrapper', 'modal-title', 'ai-assistant-btn'];
        ids.forEach(id => { elements[id] = document.getElementById(id); });
        
        initEventListeners();
        initCamera();
        initSensors();

        if (elements['opencv-js']) {
            elements['opencv-js'].onload = () => {
                let checkCvInterval = setInterval(() => {
                    if (window.cv && window.cv.imread) {
                        clearInterval(checkCvInterval);
                        cv = window.cv;
                        console.log('OpenCV.js is ready.');
                        requestAnimationFrame(comparisonLoop);
                    }
                }, 100);
            };
        }
    });

    // --- PDF関連 ---
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.worker.min.js';
    function renderPage(num) { /* ... (実装は変更なしのため省略) ... */ }
    function queueRenderPage(num) { /* ... (実装は変更なしのため省略) ... */ }

    // --- センサー関連 (GPS, 方位) ---
    function initSensors() { /* ... (実装は変更なしのため省略) ... */ }
    function handleOrientation(event) { /* ... (実装は変更なしのため省略) ... */ }

    // --- カメラ関連 (4:3対応) ---
    async function initCamera() { /* ... (実装は変更なしのため省略) ... */ }
    async function takePicture() { /* ... (実装は変更なしのため省略) ... */ }
    function addToGallery(dataUrl) { /* ... (実装は変更なしのため省略) ... */ }

    // --- AI関連 ---
    // 撮影写真の損傷分析
    async function analyzeImageWithGemini(dataUrl) {
        elements['modal-title'].innerHTML = `<span class="text-2xl mr-2">✨</span> AIによる損傷分析`;
        elements['gemini-modal'].classList.remove('hidden');
        elements['report-generation-area'].classList.add('hidden'); 
        elements['gemini-modal-content'].innerHTML = `<div class="flex flex-col justify-center items-center py-8"><div class="animate-spin rounded-full h-16 w-16 border-b-2 border-white"></div><p class="text-center mt-4">AIが分析中です...</p></div>`;
        try {
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            const base64ImageData = dataUrl.split(',')[1];
            const prompt = "この画像は構造物の点検時に撮影されたものです。コンクリートのひび割れ、剥離、鉄筋の露出、漏水、錆などの損傷の可能性を分析し、発見した点を箇条書きで簡潔に説明してください。損傷が見られない場合は「特に問題は見つかりませんでした。」と回答してください。日本語で回答してください。";
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }, { inlineData: { mimeType: "image/jpeg", data: base64ImageData } }] }] };
            const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
            if (!response.ok) throw new Error(`API Error: ${response.status} ${response.statusText}`);
            const result = await response.json();
            let analysisText = "分析結果の取得に失敗しました。";
            if (result.candidates?.[0]?.content?.parts?.[0]?.text) { analysisText = result.candidates[0].content.parts[0].text; }
            elements['gemini-modal-content'].innerHTML = `<h4 class="text-xl font-semibold">分析結果</h4><div id="gemini-modal-result" class="mt-2 p-4 bg-gray-900 rounded-lg">${analysisText.replace(/\n/g, '<br>')}</div>`;
            const generateBtn = document.createElement('button');
            generateBtn.innerHTML = `✨ 報告書を作成`;
            generateBtn.className = 'mt-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg';
            generateBtn.onclick = () => generateReportFromAnalysis(analysisText);
            elements['gemini-modal-content'].appendChild(generateBtn);
        } catch (error) {
            console.error("Gemini API Error:", error);
            elements['gemini-modal-content'].innerHTML = `<p class="text-red-400">分析中にエラーが発生しました。</p><p class="text-xs text-gray-400 mt-2">${error.message}</p>`;
        }
    }
    // 分析結果から報告書を作成
    async function generateReportFromAnalysis(analysisText) { /* ... (実装は変更なしのため省略) ... */ }
    
    // ✨ 新機能: AI撮影アシスタント
    async function getAiShootingAssistant(dataUrl) {
        elements['modal-title'].innerHTML = `<span class="text-2xl mr-2">✨</span> AI撮影アシスタント`;
        elements['gemini-modal'].classList.remove('hidden');
        elements['report-generation-area'].classList.add('hidden');
        elements['gemini-modal-content'].innerHTML = `<div class="flex flex-col justify-center items-center py-8"><div class="animate-spin rounded-full h-16 w-16 border-b-2 border-white"></div><p class="text-center mt-4">AIが写真を確認しています...</p></div>`;
        
        try {
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            const base64ImageData = dataUrl.split(',')[1];
            const prompt = `あなたは経験豊富な土木技術者です。この写真は過去の点検で撮影されたものです。
1.  この写真に写っている構造物や部材が何であるか、専門用語を使いつつ簡潔に説明してください。
2.  この後、新人技術者が同じ写真を撮影します。同じアングルや構図で撮影するための、具体的で分かりやすいアドバイスをしてください。

現在地は日本の福井県越前市です。緯度は${sensorData.latitude || '不明'}、経度は${sensorData.longitude || '不明'}です。これらの情報も参考に、回答を作成してください。

例：
**説明:** これは橋台の側面とウィング（袖壁）の接合部です。
**撮影アドバイス:** 橋台から約5m離れ、川の下流側から上流側を向いて撮影してください。太陽が背になる午前中が推奨です。`;

            const payload = { contents: [{ role: "user", parts: [{ text: prompt }, { inlineData: { mimeType: "image/jpeg", data: base64ImageData } }] }] };
            const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
            if (!response.ok) throw new Error(`API Error: ${response.status} ${response.statusText}`);
            const result = await response.json();
            let assistantText = "AIアシスタントからのアドバイスを取得できませんでした。";
            if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                assistantText = result.candidates[0].content.parts[0].text;
            }
            elements['gemini-modal-content'].innerHTML = `<div class="prose prose-invert max-w-none">${assistantText.replace(/\n/g, '<br>')}</div>`;

        } catch (error) {
            console.error("AI Assistant Error:", error);
            elements['gemini-modal-content'].innerHTML = `<p class="text-red-400">AIアシスタントの呼び出し中にエラーが発生しました。</p>`;
        }
    }


    // --- 画像比較関連 ---
    function comparisonLoop() { /* ... (実装は変更なしのため省略) ... */ }

    // --- イベントリスナーの登録 ---
    function initEventListeners() {
        elements['capture-btn'].addEventListener('click', takePicture);
        elements['ai-assistant-btn'].addEventListener('click', () => {
            if (targetImageDataUrl) {
                getAiShootingAssistant(targetImageDataUrl);
            }
        });
        
        elements['pdf-upload'].addEventListener('change', e => {
            const file = e.target.files[0];
            if (!file || file.type !== 'application/pdf') return;
            const fileReader = new FileReader();
            fileReader.onload = function() {
                const typedarray = new Uint8Array(this.result);
                pdfjsLib.getDocument(typedarray).promise.then(pdf => {
                    pdfDoc = pdf;
                    elements['page-count'].textContent = pdfDoc.numPages;
                    currentPageNum = 1;
                    renderPage(currentPageNum);
                    elements['pdf-controls'].classList.remove('hidden');
                    elements['pdf-placeholder'].classList.add('hidden');
                });
            };
            fileReader.readAsArrayBuffer(file);
        });
        
        // ... (他のイベントリスナーは省略) ...
    }
    
    // --- 省略した関数の完全な実装 ---
    // ... (このセクションには前のバージョンから変更のない、詳細な関数実装が含まれます) ...
    renderPage = (num) => {
        pageIsRendering = true; if (!pdfDoc) return;
        pdfDoc.getPage(num).then(page => {
            const container = elements['pdf-viewer-wrapper']; if (!container) return;
            const viewport = page.getViewport({ scale: 1.5 }); const scale = container.clientWidth / viewport.width;
            const scaledViewport = page.getViewport({ scale: scale }); const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d'); canvas.height = scaledViewport.height; canvas.width = scaledViewport.width;
            elements['pdf-viewer'].innerHTML = ''; elements['pdf-viewer'].appendChild(canvas);
            const renderContext = { canvasContext: context, viewport: scaledViewport };
            page.render(renderContext).promise.then(() => {
                pageIsRendering = false; if (pageNumIsPending !== null) { renderPage(pageNumIsPending); pageNumIsPending = null; }
            });
        });
        elements['page-num'].textContent = num;
    };
    queueRenderPage = (num) => { if (pageIsRendering) { pageNumIsPending = num; } else { renderPage(num); } };
    initSensors = () => { if ('geolocation' in navigator) { navigator.geolocation.watchPosition((p) => { sensorData.latitude = p.coords.latitude; sensorData.longitude = p.coords.longitude; elements['gps-status-dot'].classList.replace('bg-red-500', 'bg-green-500'); }, (e) => { console.warn(`GPSエラー: ${e.message}`); elements['gps-status-dot'].classList.replace('bg-green-500', 'bg-red-500'); }, { enableHighAccuracy: true }); } if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') { DeviceOrientationEvent.requestPermission().then(p => { if (p === 'granted') window.addEventListener('deviceorientationabsolute', handleOrientation, true); else alert('方位センサーの許可が必要です。'); }).catch(console.error); } else { window.addEventListener('deviceorientationabsolute', handleOrientation, true); } };
    handleOrientation = (event) => { if (event.alpha !== null) { sensorData.heading = event.alpha; elements['compass-status-dot'].classList.replace('bg-red-500', 'bg-green-500'); } else { elements['compass-status-dot'].classList.replace('bg-green-500', 'bg-red-500'); } };
    initCamera = async () => { try { const constraints = { video: { facingMode: 'environment', width: { ideal: 4032 }, height: { ideal: 3024 }, aspectRatio: { ideal: 4 / 3 } }, audio: false }; const stream = await navigator.mediaDevices.getUserMedia(constraints); elements['camera-stream'].srcObject = stream; } catch (err) { try { const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } }); elements['camera-stream'].srcObject = stream; } catch (e) { alert("カメラにアクセスできませんでした。"); } } };
    takePicture = async () => { const video = elements['camera-stream']; const canvas = elements['capture-canvas']; canvas.width = video.videoWidth; canvas.height = video.videoHeight; canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height); const imageDataUrl = canvas.toDataURL('image/jpeg', 1.0); if (sensorData.latitude === null || sensorData.longitude === null || sensorData.heading === null) { console.warn("センサーデータ不十分のためEXIFなし"); addToGallery(imageDataUrl); return; } const zeroth = {}; const gps = {}; zeroth[piexif.ImageIFD.Make] = "Inspection Camera App"; gps[piexif.GPSIFD.GPSLatitudeRef] = sensorData.latitude < 0 ? 'S' : 'N'; gps[piexif.GPSIFD.GPSLatitude] = piexif.GPSHelper.degToDms(Math.abs(sensorData.latitude)); gps[piexif.GPSIFD.GPSLongitudeRef] = sensorData.longitude < 0 ? 'W' : 'E'; gps[piexif.GPSIFD.GPSLongitude] = piexif.GPSHelper.degToDms(Math.abs(sensorData.longitude)); gps[piexif.GPSIFD.GPSImgDirectionRef] = "T"; gps[piexif.GPSIFD.GPSImgDirection] = [Math.round(sensorData.heading), 1]; const exifObj = {"0th":zeroth, "Exif":{}, "GPS":gps, "1st":{}, "thumbnail":null}; const exifbytes = piexif.dump(exifObj); addToGallery(piexif.insert(exifbytes, imageDataUrl)); };
    addToGallery = (dataUrl) => { elements['gallery-placeholder'].classList.add('hidden'); const photoWrapper = document.createElement('div'); photoWrapper.className = 'relative w-24 h-20 flex-shrink-0 group'; const img = document.createElement('img'); img.src = dataUrl; img.className = 'w-full h-full object-cover rounded-md'; const overlay = document.createElement('div'); overlay.className = 'absolute inset-0 bg-black bg-opacity-60 flex flex-col items-center justify-center opacity-0 group-hover:opacity-100 p-1'; const downloadLink = document.createElement('a'); downloadLink.href = dataUrl; downloadLink.download = `inspection-photo-${Date.now()}.jpg`; downloadLink.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" viewBox="0 0 256 256"><path d="M208,152v48a8,8,0,0,1-8,8H56a8,8,0,0,1-8-8V152a8,8,0,0,1,16,0v40H192V152a8,8,0,0,1,16,0ZM128,16a8,8,0,0,0-8,8V124.69L95.51,100.2a8,8,0,0,0-11,11.6l32,32a8,8,0,0,0,11,0l32-32a8,8,0,0,0-11-11.6L136,124.69V24A8,8,0,0,0,128,16Z"></path></svg>`; overlay.appendChild(downloadLink); const analyzeButton = document.createElement('button'); analyzeButton.innerHTML = `✨`; analyzeButton.title = "AIで分析"; analyzeButton.className = "text-xl mt-1"; analyzeButton.onclick = () => analyzeImageWithGemini(dataUrl); overlay.appendChild(analyzeButton); photoWrapper.appendChild(img); photoWrapper.appendChild(overlay); elements['photo-gallery'].appendChild(photoWrapper); elements['photo-gallery'].scrollLeft = elements['photo-gallery'].scrollWidth; };
    generateReportFromAnalysis = async (analysisText) => { elements['report-generation-area'].classList.remove('hidden'); elements['report-content'].innerHTML = `<div class="flex items-center justify-center h-full"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-white"></div><p class="ml-4">報告書を作成中...</p></div>`; try { const apiKey = ""; const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`; const prompt = `あなたは土木技術の専門家として、構造物の点検報告書を作成しています。以下の写真分析結果に基づき、所見、評価、および推奨される次のステップ（例：「詳細調査が必要」「経過観察」「軽微な補修」など）を含む、詳細で専門的な報告書の文章を作成してください。\n\n### 分析結果\n${analysisText}\n\n### 報告書（案）\n`; const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] }; const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) }); if (!response.ok) throw new Error(`API Error: ${response.status} ${response.statusText}`); const result = await response.json(); let reportText = "報告書の作成に失敗しました。"; if (result.candidates?.[0]?.content?.parts?.[0]?.text) { reportText = result.candidates[0].content.parts[0].text; } elements['report-content'].textContent = reportText; } catch (error) { console.error("Report Generation Error:", error); elements['report-content'].innerHTML = `<p class="text-red-400">報告書の作成中にエラーが発生しました。</p>`; } };
    comparisonLoop = () => { if (cv && isCompareMode && targetImageDataUrl && elements['camera-stream'].readyState === 4) { frameCount++; if (frameCount % 3 === 0) { try { let src = cv.imread(elements['camera-stream']); let templ = cv.imread(elements['target-image']); let result = new cv.Mat(); let mask = new cv.Mat(); cv.matchTemplate(src, templ, result, cv.TM_CCOEFF_NORMED, mask); let resultData = cv.minMaxLoc(result, mask); let maxVal = resultData.maxVal; if (maxVal > MATCH_THRESHOLD) { elements['camera-frame'].style.boxShadow = `0 0 20px 5px rgba(25, 255, 25, 0.8)`; elements['match-indicator'].textContent = `一致率: ${Math.round(maxVal * 100)}%`; elements['match-indicator'].classList.remove('hidden'); } else { elements['camera-frame'].style.boxShadow = 'none'; elements['match-indicator'].classList.add('hidden'); } src.delete(); templ.delete(); result.delete(); mask.delete(); } catch (err) { elements['camera-frame'].style.boxShadow = 'none'; elements['match-indicator'].classList.add('hidden'); } } } else { elements['camera-frame'].style.boxShadow = 'none'; elements['match-indicator'].classList.add('hidden'); } requestAnimationFrame(comparisonLoop); };

    </script>
</body>
</html>
